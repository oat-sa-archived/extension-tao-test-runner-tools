{"version":3,"sources":["routes.js","TestRunner/index.js","../templates/TestRunner/durations!tpl","TestRunner/timer.js"],"names":["define","TestRunner","css","actions","index","timer","$","_","__","loadingBar","buttonFactory","start","reload","window","location","$container","$toolbar","buttons","id","label","type","icon","renderTo","on","hb","template","Handlebars","depth0","helpers","partials","data","program1","stack1","helper","buffer","call","hash","functionType","escapeExpression","value","this","compilerInfo","merge","self","each","inverse","noop","fn","program","moment","urlHelper","Promise","loggerFactory","storeFactory","request","pollingFactory","timeEncoder","durationTpl","formatDurations","durations","dataDurations","forEach","key","push","encode","sort","a","b","localeCompare","update","dataUrl","then","itemAttemptId","isDiff","isNew","last","lastId","state","promises","localDurations","localTimers","timestamp","Date","now","timestampLabel","format","remainingLabel","isEmpty","remaining","serverDuration","server","clientDuration","client","extraDuration","extraTime","running","stopPolling","identifiers","item","attempt","durationStore","getItem","duration","isNumber","timers","timerStore","all","localDuration","startTimers","isEqual","history","unshift","shift","$content","datatable","err","logger","error","href","route","startPolling","polling","stop","show","hide","ping","currentRoute","parse","sessionId","query","deliveryExecution","decodeURIComponent","interval","action","p","promise","async","resolve","back","disable","enable","paginationStrategyTop","paginationStrategyBottom","model","store"],"mappings":"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CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnDA,ADoDA;ACnDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"taoTestRunnerTools/controller/routes.js","sourcesContent":["define('taoTestRunnerTools/controller/routes',{\n    'TestRunner': {\n        'css': 'testrunner',\n        'actions': {\n            'index': 'controller/TestRunner/index',\n            'timer': 'controller/TestRunner/timer'\n        }\n    }\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoTestRunnerTools/controller/TestRunner/index',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'layout/loading-bar',\n    'ui/button'\n], function ($, _, __, loadingBar, buttonFactory) {\n    'use strict';\n\n    return {\n        start: function start() {\n            var $container = $('.container');\n            var $toolbar = $('.toolbar', $container);\n            var $content = $('.content', $container);\n            var buttons = {};\n\n            function reload() {\n                loadingBar.start();\n                window.location.reload();\n            }\n\n            buttons.reload = buttonFactory({\n                id: 'reload',\n                label: __('Reload'),\n                type: 'info',\n                icon: 'reload',\n                renderTo: $toolbar\n            }).on('click', reload);\n        }\n    };\n});\n\n","\ndefine('tpl!taoTestRunnerTools/templates/TestRunner/durations', ['handlebars'], function(hb){ \nreturn hb.template(function (Handlebars,depth0,helpers,partials,data) {\n  this.compilerInfo = [4,'>= 1.0.0'];\nhelpers = this.merge(helpers, Handlebars.helpers); data = data || {};\n  var buffer = \"\", stack1, functionType=\"function\", escapeExpression=this.escapeExpression, self=this;\n\nfunction program1(depth0,data) {\n  \n  var buffer = \"\", stack1, helper;\n  buffer += \"\\n    <div class=\\\"duration\\\">\\n        <span class=\\\"label\\\">\";\n  if (helper = helpers.label) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.label); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n        <span class=\\\"value\\\">\";\n  if (helper = helpers.value) { stack1 = helper.call(depth0, {hash:{},data:data}); }\n  else { helper = (depth0 && depth0.value); stack1 = typeof helper === functionType ? helper.call(depth0, {hash:{},data:data}) : helper; }\n  buffer += escapeExpression(stack1)\n    + \"</span>\\n    </div>\\n    \";\n  return buffer;\n  }\n\n  buffer += \"<div class=\\\"durations\\\">\\n    \";\n  stack1 = helpers.each.call(depth0, depth0, {hash:{},inverse:self.noop,fn:self.program(1, program1, data),data:data});\n  if(stack1 || stack1 === 0) { buffer += stack1; }\n  buffer += \"\\n</div>\\n\";\n  return buffer;\n  });\n});\n\n","/**\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; under version 2\n * of the License (non-upgradable).\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n * GNU General Public License for more details.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n *\n * Copyright (c) 2017 (original work) Open Assessment Technologies SA ;\n */\n/**\n * @author Jean-Sébastien Conan <jean-sebastien@taotesting.com>\n */\ndefine('taoTestRunnerTools/controller/TestRunner/timer',[\n    'jquery',\n    'lodash',\n    'i18n',\n    'moment',\n    'util/url',\n    'core/promise',\n    'core/logger',\n    'core/store',\n    'core/dataProvider/request',\n    'core/polling',\n    'core/encoder/time',\n    'layout/loading-bar',\n    'tpl!taoTestRunnerTools/templates/TestRunner/durations',\n    'ui/button',\n    'ui/datatable'\n], function ($,\n             _,\n             __,\n             moment,\n             urlHelper,\n             Promise,\n             loggerFactory,\n             storeFactory,\n             request,\n             pollingFactory,\n             timeEncoder,\n             loadingBar,\n             durationTpl,\n             buttonFactory) {\n    'use strict';\n\n    function formatDurations(durations) {\n        var dataDurations = [];\n\n        _.forEach(durations, function (value, key) {\n            dataDurations.push({\n                label: key,\n                value: value && timeEncoder.encode(value + 's') || '-'\n            });\n        });\n\n        dataDurations.sort(function (a, b) {\n            return a.label.localeCompare(b.label);\n        });\n\n        return durationTpl(dataDurations);\n    }\n\n    return {\n        start: function start() {\n            var $container = $('.container');\n            var $toolbar = $('.toolbar', $container);\n            var $content = $('.content', $container);\n\n            var currentRoute = urlHelper.parse(window.location.href);\n            var sessionId = currentRoute.query.deliveryExecution && decodeURIComponent(currentRoute.query.deliveryExecution);\n            var dataUrl = urlHelper.route('deliveryExecutionData', 'TestRunner', 'taoTestRunnerTools', {deliveryExecution: sessionId});\n\n            var history = [];\n            var last, lastId;\n            var buttons = {};\n            var timerStore, durationStore;\n\n            var logger = loggerFactory('taoTestRunnerTools/TestRunner/timer');\n\n            var polling = pollingFactory({\n                interval: 1000,\n                action: function action(p) {\n                    var promise = p.async();\n                    update().then(function () {\n                        promise.resolve();\n                    });\n                }\n            });\n\n            function update() {\n                return request(dataUrl)\n                    .then(function (data) {\n                        var isNew = !last || lastId !== data.id || last.state !== data.state;\n                        var itemAttemptId;\n                        var isDiff;\n                        var promises = [];\n                        var localDurations = {};\n                        var localTimers = {};\n\n                        data.timestamp = Date.now();\n                        data.timestampLabel = moment(data.timestamp).format('LLL');\n                        data.remainingLabel = _.isEmpty(data.remaining) ? '-' : timeEncoder.encode(data.remaining);\n                        data.serverDuration = data.durations && formatDurations(data.durations.server);\n                        data.clientDuration = data.durations && formatDurations(data.durations.client);\n                        data.extraDuration = data.extraTime && formatDurations(data.extraTime);\n\n                        if (!data.running) {\n                            stopPolling();\n                        }\n\n                        if (data.identifiers) {\n                            itemAttemptId = data.identifiers.item + '#' + data.identifiers.attempt;\n                            promises.push(durationStore.getItem(itemAttemptId).then(function (duration) {\n                                localDurations.duration = _.isNumber(duration) ? duration : 0;\n                            }));\n                        }\n\n                        if (data.timers) {\n                            _.forEach(data.timers, function (timer) {\n                                promises.push(timerStore.getItem(timer.id).then(function (remaining) {\n                                    localTimers[timer.label] = _.isNumber(remaining) ? remaining / 1000 : 0;\n                                }));\n                            });\n                        }\n\n                        return Promise.all(promises).then(function () {\n                            data.localDuration = formatDurations(localDurations);\n                            data.localTimers = formatDurations(localTimers);\n                            if (!last || isNew) {\n                                data.startTimers = data.localTimers;\n                            } else if (last.startTimers) {\n                                data.startTimers = last.startTimers;\n                            }\n\n                            isDiff = !_.isEqual(last, data);\n                            last = data;\n                            lastId = data.id;\n\n                            if (isNew) {\n                                history.unshift(data);\n                            } else if (isDiff) {\n                                history.shift();\n                                history.unshift(data);\n                            }\n\n                            if (isNew || isDiff) {\n                                $content.datatable('refresh', {\n                                    data: history\n                                });\n                            }\n                        });\n                    })\n                    .catch(function (err) {\n                        logger.error(err);\n                    });\n            }\n\n            function reload() {\n                stopPolling();\n                loadingBar.start();\n                window.location.reload();\n            }\n\n            function index() {\n                stopPolling();\n                loadingBar.start();\n                window.location.href = urlHelper.route('index', 'TestRunner', 'taoTestRunnerTools');\n            }\n\n            function startPolling() {\n                polling.start();\n                buttons.stop.show();\n                buttons.start.hide();\n                buttons.ping.hide();\n            }\n\n            function stopPolling() {\n                polling.stop();\n                buttons.stop.hide();\n                buttons.start.show();\n                buttons.ping.show();\n            }\n\n            buttons.back = buttonFactory({\n                id: 'back',\n                label: __('Index'),\n                type: 'info',\n                icon: 'left',\n                renderTo: $toolbar\n            }).on('click', index);\n\n            buttons.reload = buttonFactory({\n                id: 'reload',\n                label: __('Reload'),\n                type: 'info',\n                icon: 'reload',\n                renderTo: $toolbar\n            }).on('click', reload);\n\n            buttons.start = buttonFactory({\n                id: 'start',\n                label: __('Start watching'),\n                type: 'info',\n                icon: 'play',\n                renderTo: $toolbar\n            }).on('click', startPolling).hide();\n\n            buttons.stop = buttonFactory({\n                id: 'stop',\n                label: __('Stop watching'),\n                type: 'info',\n                icon: 'stop',\n                renderTo: $toolbar\n            }).on('click', stopPolling).hide();\n\n            buttons.ping = buttonFactory({\n                id: 'ping',\n                label: __('Ping'),\n                type: 'info',\n                icon: 'target',\n                renderTo: $toolbar\n            }).on('click', function() {\n                buttons.ping.disable();\n                update().then(function() {\n                    buttons.ping.enable();\n                });\n            }).hide();\n\n            $content.datatable({\n                paginationStrategyTop: 'none',\n                paginationStrategyBottom: 'none',\n                model: [{\n                    id: 'timestampLabel',\n                    label: __('Timestamp')\n                }, {\n                    id: 'state',\n                    label: __('State')\n                }, {\n                    id: 'position',\n                    label: __('Position')\n                }, {\n                    id: 'remainingLabel',\n                    label: __('Server Timer')\n                }, {\n                    id: 'serverDuration',\n                    label: __('Server durations')\n                }, {\n                    id: 'clientDuration',\n                    label: __('Client durations')\n                }, {\n                    id: 'extraDuration',\n                    label: __('Extra time')\n                }, {\n                    id: 'localDuration',\n                    label: __('Browser durations')\n                }, {\n                    id: 'localTimers',\n                    label: __('Client Timers')\n                }, {\n                    id: 'startTimers',\n                    label: __('From timers')\n                }]\n            });\n\n            Promise.all([\n                storeFactory('timer-' + sessionId).then(function (store) {\n                    timerStore = store;\n                }),\n                storeFactory('duration-' + sessionId).then(function (store) {\n                    durationStore = store;\n                })\n            ]).then(function () {\n                startPolling();\n            }).catch(function (err) {\n                logger.error(err);\n            });\n        }\n    };\n});\n\n"]}